----- Control the startup of Podman containers with systemd -----

# Pull image and start container:
podman pull docker.io/redis
sudo podman run -d --name redis -p 6379:6379 redis


# Open Selinux permission.
# If SELinux is enabled on your system, you must turn on the container_manage_cgroup boolean to run containers with systemd
sudo setsebool -P container_manage_cgroup on


# Confirm container is running:
[root@el8 ~]# podman ps
CONTAINER ID  IMAGE                                   COMMAND       CREATED         STATUS                     PORTS                   NAMES
37f6e41421c7  docker.io/library/redis:latest          redis-server  2 minutes ago   Up Less than a second ago  0.0.0.0:6379->6379/tcp  redis

# Create Systemd service:

vim /etc/systemd/system/redis.service:

[Unit]
Description=Redis Podman container
Wants=syslog.service
[Service]
Restart=always
ExecStart=/usr/bin/podman start -a redis
ExecStop=/usr/bin/podman stop -t 10 redis
[Install]
WantedBy=multi-user.target

# Enable and start the systemd service:
sudo systemctl enable --now redis.service

# Stop the container:
[root@el8 ~]# podman stop redis
37f6e41421c7dc831a27d1c2a7244be3d30471e896e1e5c0f91e48213120e772

# Confirm that it was started again:
[root@el8 ~]# podman ps
CONTAINER ID  IMAGE                                   COMMAND       CREATED         STATUS                     PORTS                   NAMES
37f6e41421c7  docker.io/library/redis:latest          redis-server  5 minutes ago   Up Less than a second ago  0.0.0.0:6379->6379/tcp  redis
